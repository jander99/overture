# Overture Configuration Examples

## Example 1: Python FastAPI Backend

### `.overture/config.yaml`

```yaml
version: "1.0"

project:
  name: fastapi-backend
  type: python-backend
  description: REST API built with FastAPI and PostgreSQL

# Plugins to install
plugins:
  python-development:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [python-repl, ruff, filesystem]

  backend-development:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [docker, filesystem]

  database-design:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [sqlite, filesystem]

  testing:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [filesystem]

# MCP server configurations
mcp:
  # Global MCPs (reference only)
  filesystem:

  # Project MCPs
  python-repl:
    command: uvx
    args: [mcp-server-python-repl]

  ruff:
    command: uvx
    args: [mcp-server-ruff]

  docker:
    command: docker-mcp-server

  sqlite:
    command: uvx
    args: [mcp-server-sqlite, --db-path, ./dev.db]

  github:
    command: mcp-server-github
    env:
      GITHUB_TOKEN: "${GITHUB_TOKEN}"

  postgres:
    command: docker
    args: [run, -i, --rm, mcp-postgres]
    env:
      POSTGRES_URL: "${DATABASE_URL}"
    enabled: false
```

### Generated `CLAUDE.md`

```markdown
# FastAPI Backend Project

Generated by Overture v1.0.0

## Project Info
- Name: fastapi-backend
- Type: python-backend
- Description: REST API built with FastAPI and PostgreSQL

## Active Plugins

- **python-development** (marketplace: claude-code-workflows)
- **backend-development** (marketplace: claude-code-workflows)
- **database-design** (marketplace: claude-code-workflows)
- **testing** (marketplace: claude-code-workflows)

## MCP Server Configuration

### Global MCP Servers
Available in all projects (configured in ~/.claude.json):
- filesystem
- context7
- memory
- sequentialthinking

### Project MCP Servers
Configured for this project (in .mcp.json):
- **python-repl**
- **ruff**
- **docker**
- **sqlite**
- **github**
- **postgres** ‚ö†Ô∏è DISABLED (enable with: `overture enable mcp postgres`)

## Plugin-to-MCP Mappings

This section tells Claude which MCP servers to use for each plugin.

### python-development
When using python-development, prefer these MCP servers:
- `python-repl` MCP
- `ruff` MCP
- `filesystem` MCP

### backend-development
When using backend-development, prefer these MCP servers:
- `docker` MCP
- `filesystem` MCP

### database-design
When using database-design, prefer these MCP servers:
- `sqlite` MCP
- `filesystem` MCP

### testing
When using testing, prefer these MCP servers:
- `filesystem` MCP

---
*Auto-generated by Overture. Manual edits below will be preserved.*

<!-- overture:custom -->
## Project-Specific Notes

This is a FastAPI backend with PostgreSQL. For local development:
- Use `docker-compose up` to start services
- Run migrations with `alembic upgrade head`
- Tests use SQLite in-memory database
<!-- /overture:custom -->
```

---

## Example 2: Java Spring Boot Application

### `.overture/config.yaml`

```yaml
version: "1.0"

project:
  name: spring-boot-app
  type: java-spring
  description: Microservice built with Spring Boot

plugins:
  jvm-languages:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [maven, filesystem]

  backend-development:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [filesystem]

  testing:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [filesystem]

mcp:
  filesystem:

  maven:
    command: mcp-server-maven

  kubernetes:
    command: kubectl-mcp-server

  postgres:
    command: docker
    args: [run, -i, --rm, mcp-postgres]
    env:
      POSTGRES_URL: "${DATABASE_URL}"
```

### Generated `CLAUDE.md`

```markdown
# Spring Boot App

Generated by Overture v1.0.0

## Active Plugins

- **jvm-languages** (marketplace: claude-code-workflows)
- **backend-development** (marketplace: claude-code-workflows)
- **testing** (marketplace: claude-code-workflows)

## MCP Server Configuration

### Global MCP Servers
- filesystem
- context7
- memory

### Project MCP Servers
- **maven**
- **kubernetes**
- **postgres**

## Plugin-to-MCP Mappings

### jvm-languages
When using jvm-languages, prefer these MCP servers:
- `maven` MCP
- `filesystem` MCP

### backend-development
When using backend-development, prefer these MCP servers:
- `filesystem` MCP

### testing
When using testing, prefer these MCP servers:
- `filesystem` MCP

---
*Auto-generated by Overture.*

<!-- overture:custom -->
<!-- /overture:custom -->
```

---

## Example 3: Frontend React Application

### `.overture/config.yaml`

```yaml
version: "1.0"

project:
  name: react-dashboard
  type: frontend-react
  description: Admin dashboard built with React and TypeScript

plugins:
  javascript-typescript:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [node, npm, filesystem]

  frontend-development:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [filesystem]

  testing:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [playwright, filesystem]

mcp:
  filesystem:

  node:
    command: node-mcp-server

  npm:
    command: npm-mcp-server

  playwright:
    command: playwright-mcp-server
    enabled: false
```

### Generated `CLAUDE.md` (excerpt)

```markdown
# React Dashboard

## Active Plugins

- **javascript-typescript** (marketplace: claude-code-workflows)
- **frontend-development** (marketplace: claude-code-workflows)
- **testing** (marketplace: claude-code-workflows)

## Plugin-to-MCP Mappings

### javascript-typescript
When using javascript-typescript, prefer these MCP servers:
- `node` MCP
- `npm` MCP
- `filesystem` MCP

### frontend-development
When using frontend-development, prefer these MCP servers:
- `filesystem` MCP

### testing
When using testing, prefer these MCP servers:
- `playwright` MCP
- `filesystem` MCP
```

---

## Example 4: Nx Monorepo (Current Overture Project)

### `.overture/config.yaml`

```yaml
version: "1.0"

project:
  name: overture
  type: typescript-monorepo
  description: Configuration management for Claude Code

plugins:
  javascript-typescript:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [filesystem, nx]

  developer-essentials:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [filesystem, nx]

  testing:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [filesystem]

  git-pr-workflows:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [github, filesystem]

mcp:
  filesystem:

  nx:

  github:
    command: mcp-server-github
    env:
      GITHUB_TOKEN: "${GITHUB_TOKEN}"
```

### Generated `CLAUDE.md`

```markdown
# Overture - Configuration Management for Claude Code

Generated by Overture v1.0.0

## Active Plugins

- **javascript-typescript** (marketplace: claude-code-workflows)
- **developer-essentials** (marketplace: claude-code-workflows)
- **testing** (marketplace: claude-code-workflows)
- **git-pr-workflows** (marketplace: claude-code-workflows)

## MCP Server Configuration

### Global MCP Servers
- filesystem
- nx
- context7
- memory
- sequentialthinking

### Project MCP Servers
- **github**

## Plugin-to-MCP Mappings

### javascript-typescript
When using javascript-typescript, prefer these MCP servers:
- `filesystem` MCP
- `nx` MCP

### developer-essentials
When using developer-essentials, prefer these MCP servers:
- `filesystem` MCP
- `nx` MCP

### testing
When using testing, prefer these MCP servers:
- `filesystem` MCP

### git-pr-workflows
When using git-pr-workflows, prefer these MCP servers:
- `github` MCP
- `filesystem` MCP

---
*Auto-generated by Overture.*

<!-- overture:custom -->
## Development Notes

When working on Overture itself, remember:
- This tool will eventually generate its own CLAUDE.md
- Test configuration generation on sample projects in `dev/sample-config/`
- Always run tasks through `nx` (e.g., `nx build @overture/cli`)
<!-- /overture:custom -->
```

---

## Comparison: Without vs With Overture

### Without Overture

**Manual Process:**
1. Install plugins manually: `/plugin install python-development`
2. Separately configure MCP servers in `.mcp.json`
3. No connection between plugins and MCPs
4. No guidance for Claude on tool selection
5. Duplicate configuration across similar projects

**Claude's Perspective:**
- Knows plugins are installed
- Knows MCP servers are available
- ‚ùå Doesn't know which MCPs to prefer for which plugins
- ‚ùå No guidance on when to use which tool
- Must discover tool relationships through trial and error

### With Overture

**Configuration-Driven:**
1. Edit `.overture/config.yaml` once to declare plugins and MCPs
2. Run `overture sync`
3. Overture installs plugins via Claude CLI
4. Generates `.mcp.json` with project-scoped MCPs
5. Generates `CLAUDE.md` with plugin‚ÜîMCP mappings
6. Commit config to version control for consistent environments

**Claude's Perspective:**
- Knows plugins are installed
- Knows MCP servers are available
- ‚úÖ Reads CLAUDE.md and knows which MCPs to prefer for each plugin
- ‚úÖ Has explicit guidance: "When using python-development ‚Üí use python-repl"
- ‚úÖ Understands the relationship between plugins and tools
- ‚úÖ Provides better user experience with appropriate tool selection

---

## Example 5: Using Doctor for Troubleshooting

### Scenario

You're experiencing issues with MCP synchronization and want to diagnose the problem.

### Step 1: Run Doctor Command

```bash
overture doctor --verbose
```

### Sample Output

```
Checking client installations...

‚úì claude-code (v2.1.0) - /usr/local/bin/claude
  Config: /home/user/.claude.json (valid)

‚ö† vscode - /usr/bin/code
  Config: /home/user/.vscode/mcp.json (invalid)
  Warning: Config file has JSON syntax error at line 15

‚úó cursor - not installed
  ‚Üí Install Cursor: https://cursor.com

‚úó claude-desktop - not installed
  ‚Üí Install Claude Desktop: https://claude.com/download

Checking MCP servers...

‚úì github - gh (found)
‚úì python-repl - uvx (found)
‚ö† custom-tool - /usr/local/bin/custom-tool (not found)
  ‚Üí Ensure custom-tool is installed and available in PATH

Summary:
  Clients detected: 2 / 7
  Clients missing:  5
  Configs valid:    1
  Configs invalid:  1
  MCP commands available: 2 / 3
  MCP commands missing:   1
```

### Step 2: Diagnose Issues

From the output, we can see:

1. **VSCode config is invalid** - JSON syntax error
2. **Custom-tool not found** - Not in PATH
3. **Cursor and Claude Desktop not installed** - Expected if you don't use them

### Step 3: Fix VSCode Config

```bash
# Option 1: Backup and regenerate
mv ~/.vscode/mcp.json ~/.vscode/mcp.json.backup
overture sync --client vscode

# Option 2: Fix manually
# Edit ~/.vscode/mcp.json and fix JSON syntax
```

### Step 4: Fix Custom Tool PATH

```bash
# Add to PATH
export PATH="/usr/local/bin:$PATH"

# Or install the tool
npm install -g custom-tool

# Verify
which custom-tool
```

### Step 5: Verify Fixes

```bash
overture doctor

# Should now show:
# ‚úì vscode - /usr/bin/code
#   Config: /home/user/.vscode/mcp.json (valid)
# ‚úì custom-tool - /usr/local/bin/custom-tool (found)
```

### JSON Output for Automation

```bash
overture doctor --json > doctor-report.json
```

**`doctor-report.json`:**
```json
{
  "clients": [
    {
      "client": "claude-code",
      "status": "found",
      "binaryPath": "/usr/local/bin/claude",
      "version": "2.1.0",
      "configPath": "/home/user/.claude.json",
      "configValid": true,
      "warnings": []
    },
    {
      "client": "vscode",
      "status": "found",
      "binaryPath": "/usr/bin/code",
      "configPath": "/home/user/.vscode/mcp.json",
      "configValid": false,
      "warnings": [
        "Config file exists but is invalid JSON"
      ]
    }
  ],
  "mcpServers": [
    {
      "name": "github",
      "command": "gh",
      "available": true
    },
    {
      "name": "custom-tool",
      "command": "/usr/local/bin/custom-tool",
      "available": false
    }
  ],
  "summary": {
    "clientsDetected": 2,
    "clientsMissing": 5,
    "configsValid": 1,
    "configsInvalid": 1,
    "mcpCommandsAvailable": 2,
    "mcpCommandsMissing": 1
  }
}
```

### Use Cases for Doctor

**Before Initial Setup:**
```bash
# Check what's already installed
overture doctor
```

**After Installation Issues:**
```bash
# Diagnose why sync isn't working
overture doctor --verbose
```

**In CI/CD:**
```bash
# Verify environment before deployment
overture doctor --json | jq '.summary.configsValid'
```

**Team Onboarding:**
```bash
# New team member checks what they need
overture doctor
# Shows clear list of missing clients and tools
```

---

## Example 6: CI/CD Configuration Generation

### Scenario

You want to generate MCP configs in GitHub Actions without installing AI clients in your CI environment.

### `.overture/config.yaml` for CI

```yaml
version: "1.0"

project:
  name: my-api
  type: python-backend

# Skip binary detection in CI environments
skipBinaryDetection: true

mcp:
  github:
    command: gh
    args: [mcp]
    env:
      GITHUB_TOKEN: "${GITHUB_TOKEN}"

  filesystem:
    command: npx
    args: [-y, mcp-server-filesystem]

  python-repl:
    command: uvx
    args: [mcp-server-python-repl]

  ruff:
    command: uvx
    args: [mcp-server-ruff]
```

### GitHub Actions Workflow

**`.github/workflows/generate-configs.yml`:**

```yaml
name: Generate MCP Configs

on:
  push:
    branches: [main]
    paths:
      - '.overture/config.yaml'
  pull_request:
    paths:
      - '.overture/config.yaml'

jobs:
  generate:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install Overture
        run: npm install -g @overture/cli

      - name: Verify Overture installation
        run: overture --version

      - name: Generate configs (dry-run)
        run: |
          overture sync --dry-run
          echo "Generated configs:"
          ls -la dist/

      - name: Validate generated configs
        run: |
          # Check if configs are valid JSON
          for file in dist/*.json; do
            echo "Validating $file"
            jq empty "$file" || exit 1
          done

      - name: Upload generated configs
        uses: actions/upload-artifact@v3
        with:
          name: mcp-configs
          path: dist/
          retention-days: 30

      - name: Comment on PR with config summary
        if: github.event_name == 'pull_request'
        uses: actions/github-script@v6
        with:
          script: |
            const fs = require('fs');
            const files = fs.readdirSync('dist').filter(f => f.endsWith('.json'));

            const comment = `## üîß Generated MCP Configs\n\n` +
              `Total configs: ${files.length}\n\n` +
              `Files:\n${files.map(f => `- \`${f}\``).join('\n')}`;

            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: comment
            });
```

### Docker Container Build

**`Dockerfile`:**

```dockerfile
FROM node:18-alpine

# Install Overture
RUN npm install -g @overture/cli

# Copy configuration
COPY .overture/config.yaml /app/.overture/config.yaml
WORKDIR /app

# Generate configs
RUN overture sync --dry-run

# Configs are now in /app/dist/
# Copy to final destination or use in application
```

### Pre-commit Hook for Config Validation

**`.git/hooks/pre-commit`:**

```bash
#!/bin/bash

# Validate Overture config before committing
if [ -f .overture/config.yaml ]; then
  echo "Validating Overture configuration..."

  if ! overture validate; then
    echo "‚ùå Overture config validation failed"
    exit 1
  fi

  echo "‚úÖ Overture config valid"
fi

exit 0
```

Make executable:
```bash
chmod +x .git/hooks/pre-commit
```

### Benefits of CI/CD Integration

1. **Consistent Configs** - Same configs generated in all environments
2. **Early Validation** - Catch config errors before deployment
3. **Documentation** - PR comments show what configs changed
4. **Reproducibility** - Anyone can regenerate exact same configs
5. **No Manual Steps** - Fully automated config generation

### Advanced: Multi-Environment Configs

**`.overture/config.dev.yaml`:**
```yaml
version: "1.0"
skipBinaryDetection: true

mcp:
  github:
    command: gh
    args: [mcp]
    env:
      GITHUB_TOKEN: "${GITHUB_DEV_TOKEN}"
```

**`.overture/config.prod.yaml`:**
```yaml
version: "1.0"
skipBinaryDetection: true

mcp:
  github:
    command: gh
    args: [mcp]
    env:
      GITHUB_TOKEN: "${GITHUB_PROD_TOKEN}"
```

**GitHub Actions:**
```yaml
- name: Generate dev configs
  run: overture sync --config .overture/config.dev.yaml --dry-run

- name: Generate prod configs
  run: overture sync --config .overture/config.prod.yaml --dry-run
```

### Testing Config Changes

```yaml
- name: Test config changes
  run: |
    # Generate configs
    overture sync --dry-run

    # Compare with previous version
    git fetch origin main
    git show origin/main:dist/claude-code-mcp.json > old-config.json

    # Show diff
    diff -u old-config.json dist/claude-code-mcp.json || true

    # Validate no breaking changes
    # (Add custom validation logic here)
```

---

---

## Example 7: OpenCode + Claude Code Hybrid Setup

### Scenario

You want to leverage both Claude Code (with its rich plugin ecosystem) and OpenCode (with its granular permissions and UI features). Overture manages MCPs for both tools from a single configuration.

### `.overture/config.yaml`

```yaml
version: "1.0"

project:
  name: hybrid-python-backend
  type: python-backend
  description: Python backend using both Claude Code and OpenCode

# Plugins for Claude Code
plugins:
  python-development:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [python-repl, ruff, filesystem]

  backend-development:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [docker, filesystem]

  testing:
    marketplace: claude-code-workflows
    enabled: true
    mcps: [filesystem]

# MCP server configurations (shared across both tools)
mcp:
  # Global MCPs (reference only)
  filesystem:

  # Project MCPs (synced to both Claude Code and OpenCode)
  python-repl:
    command: uvx
    args: [mcp-server-python-repl]

  ruff:
    command: uvx
    args: [mcp-server-ruff]

  docker:
    command: docker-mcp-server

  github:
    command: mcp-server-github
    env:
      GITHUB_TOKEN: "${GITHUB_TOKEN}"

# OpenCode-specific configuration
opencode:
  sync_agents_md: true
  preserve_manual_mcps: true
  merge_strategy: merge
```

### Generated `.mcp.json` (Claude Code)

```json
{
  "mcpServers": {
    "python-repl": {
      "command": "uvx",
      "args": ["mcp-server-python-repl"]
    },
    "ruff": {
      "command": "uvx",
      "args": ["mcp-server-ruff"]
    },
    "docker": {
      "command": "docker-mcp-server"
    },
    "github": {
      "command": "mcp-server-github",
      "env": {
        "GITHUB_TOKEN": "${GITHUB_TOKEN}"
      }
    }
  }
}
```

### Generated `opencode.json` (OpenCode)

```json
{
  "model": "anthropic/claude-sonnet-4-5",
  "agent": {
    "security-reviewer": {
      "description": "Custom security agent for code audits",
      "mode": "subagent",
      "tools": {
        "write": false,
        "bash": false
      }
    }
  },
  "permission": {
    "bash": {
      "*": "ask",
      "git *": "allow",
      "npm install": "deny"
    }
  },
  "mcp": {
    "python-repl": {
      "type": "local",
      "enabled": true,
      "command": ["uvx", "mcp-server-python-repl"]
    },
    "ruff": {
      "type": "local",
      "enabled": true,
      "command": ["uvx", "mcp-server-ruff"]
    },
    "docker": {
      "type": "local",
      "enabled": true,
      "command": ["docker-mcp-server"]
    },
    "github": {
      "type": "local",
      "enabled": true,
      "command": ["mcp-server-github"],
      "environment": {
        "GITHUB_TOKEN": "{env:GITHUB_TOKEN}"
      }
    },
    "my-custom-mcp": {
      "type": "local",
      "enabled": true,
      "command": ["custom-mcp-server"],
      "_comment": "Manually added - preserved by Overture"
    }
  },
  "theme": "monokai",
  "autoupdate": true
}
```

### Generated `CLAUDE.md`

```markdown
# Hybrid Python Backend Project

Generated by Overture v1.0.0

## Project Info
- Name: hybrid-python-backend
- Type: python-backend
- Description: Python backend using both Claude Code and OpenCode

## Active Plugins (Claude Code)

- **python-development** (marketplace: claude-code-workflows)
- **backend-development** (marketplace: claude-code-workflows)
- **testing** (marketplace: claude-code-workflows)

## MCP Server Configuration

### Global MCP Servers
Available in all projects:
- filesystem
- context7
- memory
- sequentialthinking

### Project MCP Servers
Configured for this project:
- **python-repl**
- **ruff**
- **docker**
- **github**

## Plugin-to-MCP Mappings

### python-development
When using python-development, prefer these MCP servers:
- `python-repl` - Execute Python code for validation and testing
- `ruff` - Lint, format, and check Python code quality
- `filesystem` - Read/write project files

### backend-development
When using backend-development, prefer these MCP servers:
- `docker` - Manage containerized services
- `filesystem` - Read/write project files

### testing
When using testing, prefer these MCP servers:
- `filesystem` - Read/write test files

---
*Auto-generated by Overture. Manual edits below will be preserved.*

<!-- overture:custom -->
## OpenCode Configuration

This project uses OpenCode alongside Claude Code for hybrid workflow:
- **Claude Code**: Rich plugin ecosystem for automation and code generation
- **OpenCode**: Granular permissions and custom agent system for safety

Both tools share the same MCP servers for consistency.

### OpenCode Agents

Custom agents available in OpenCode:
- **security-reviewer** - Analyzes code for security issues (subagent)

### OpenCode Permissions

Bash commands require approval except for safe git operations.
Custom permissions prevent destructive operations (npm install blocked).

See `opencode.json` for complete configuration.
<!-- /overture:custom -->
```

### Generated `AGENTS.md` (OpenCode)

```markdown
# Hybrid Python Backend Project

Generated by Overture v1.0.0

## Project Info
- Name: hybrid-python-backend
- Type: python-backend
- Description: Python backend using both Claude Code and OpenCode

## Active Plugins (Claude Code)

These plugins are available via Claude Code integration:
- **python-development** (marketplace: claude-code-workflows)
- **backend-development** (marketplace: claude-code-workflows)
- **testing** (marketplace: claude-code-workflows)

## MCP Server Configuration

### Global MCP Servers
Available in all projects:
- filesystem
- context7
- memory
- sequentialthinking

### Project MCP Servers
Configured for this project (synced by Overture):
- **python-repl** - Execute Python code
- **ruff** - Python linting and formatting
- **docker** - Container management
- **github** - GitHub API access

## Plugin-to-MCP Mappings

Guidance for using Claude Code plugins with MCP servers:

### python-development
When using python-development, prefer these MCP servers:
- `python-repl` - Execute Python code for validation and testing
- `ruff` - Lint, format, and check Python code quality
- `filesystem` - Read/write project files

### backend-development
When using backend-development, prefer these MCP servers:
- `docker` - Manage containerized services
- `filesystem` - Read/write project files

### testing
When using testing, prefer these MCP servers:
- `filesystem` - Read/write test files

---
*Auto-generated by Overture. Manual edits below will be preserved.*

<!-- overture:custom -->
## OpenCode Configuration Notes

This project uses Overture to manage MCPs for both Claude Code and OpenCode.

### Custom Agents

**security-reviewer** (subagent)
- Analyzes code for security vulnerabilities
- Read-only mode (no write/bash access)
- Useful for PR reviews before merge

### Permission Guidelines

**Bash Commands:**
- All commands: require approval by default
- Git commands: auto-approved for workflow efficiency
- Destructive commands (npm install, rm -rf): denied for safety

**When to Use Each Tool:**
- **Claude Code:** Complex workflows, automation, generating code, running plugins
- **OpenCode:** Tasks requiring fine-grained permissions, security reviews, interactive debugging

### Consistency

MCPs are synchronized from `.overture/config.yaml` to both `.mcp.json` (Claude Code) and `opencode.json` (OpenCode).
Run `overture sync` after updating MCP configuration.

<!-- /overture:custom -->
```

### Usage Workflow

#### Step 1: Sync Configuration to Both Tools

```bash
# Edit Overture config
vim .overture/config.yaml

# Sync to both Claude Code and OpenCode
overture sync

# Output:
# ‚úì Claude Code (.mcp.json): 4 MCP servers configured
# ‚úì OpenCode (opencode.json): 4 MCP servers (patched), custom agents preserved
# ‚úì Generated: CLAUDE.md
# ‚úì Generated: AGENTS.md
```

#### Step 2: Use Claude Code for Plugins

```bash
# Claude Code uses plugins for code generation and automation
claude code

# The python-development plugin will leverage:
# - python-repl for testing code changes
# - ruff for code formatting
# - filesystem for reading/writing files
```

#### Step 3: Use OpenCode for Controlled Tasks

```bash
# OpenCode uses permissions system for safe execution
opencode

# The security-reviewer agent can audit code without write access
# All bash commands require approval
# Git operations auto-approved for workflow efficiency
```

### What It Does

- **Unified MCP Management**: Declare MCP servers once in `.overture/config.yaml`, automatically sync to both `.mcp.json` (Claude Code) and `opencode.json` (OpenCode)
- **Multi-Client Sync**: Single `overture sync` command updates both tools simultaneously without manual duplication
- **Configuration Preservation**: OpenCode's custom agents, commands, permissions, themes, and manually-added MCPs are preserved during sync through intelligent JSON patching
- **Plugin Integration**: Claude Code plugins provide rich automation workflows while OpenCode provides fine-grained control
- **Permissions Control**: OpenCode's granular permission system adds safety guardrails even while leveraging shared MCPs
- **Consistent Environment**: Both tools access the same MCP servers, ensuring consistent capabilities across tools
- **Best of Both Worlds**: Combine Claude Code's plugin ecosystem with OpenCode's permissions and UI features

### Best Practices

- **Separation of Concerns**: Use Claude Code for plugin-driven workflows (python-development, backend-development). Use OpenCode when you need granular permission control or custom agents for sensitive operations.

- **MCP Configuration Management**: Always edit MCPs in `.overture/config.yaml`, never directly in `opencode.json` or `.mcp.json`. This ensures consistency across both tools and allows `overture sync` to maintain proper state.

- **Custom Config Preservation**: Set `opencode.preserve_manual_mcps: true` to keep any manually-added MCP servers in `opencode.json` that aren't defined in Overture config.

- **Team Collaboration**: Commit `.overture/config.yaml` to version control. Team members run `overture sync` to get consistent setup for both Claude Code and OpenCode with a single command.

- **Verification After Sync**: Test MCPs in both tools after running `overture sync`:
  ```bash
  # Verify Claude Code
  claude mcp list
  # Verify OpenCode
  opencode mcp list --json
  ```

- **Backup Before Major Changes**: Before significant configuration changes, create a backup:
  ```bash
  overture backup create
  # List available backups
  overture backup list
  # Restore if needed
  overture backup restore claude-code <timestamp>
  ```

### Related Examples

- **Example 1:** Python FastAPI Backend - Similar MCP configuration pattern
- **Example 4:** Nx Monorepo (Overture itself) - Complex multi-plugin setup showing advanced configurations
- **[OpenCode Integration Research](../opencode-integration-research.md)** - Comprehensive technical details on OpenCode features, JSON patching strategy, and implementation approach

---

## Summary

These examples demonstrate:

1. **Example 1-4** - Project-type specific configurations
2. **Example 5** - System diagnostics and troubleshooting with `overture doctor`
3. **Example 6** - CI/CD integration for automated config generation
4. **Example 7** - Hybrid setup combining Claude Code and OpenCode

**Key Takeaways:**

- Use `overture doctor` to diagnose client detection and config validity issues
- Set `skipBinaryDetection: true` for CI/CD environments where clients aren't installed
- Integrate Overture into your CI/CD pipelines for consistent config generation
- Leverage JSON output mode for automation and programmatic checks
- Use dry-run mode to preview configs before applying them
- Use `opencode.sync_agents_md: true` to auto-generate AGENTS.md for OpenCode
- Manage MCPs once, sync to both Claude Code and OpenCode with `overture sync`
